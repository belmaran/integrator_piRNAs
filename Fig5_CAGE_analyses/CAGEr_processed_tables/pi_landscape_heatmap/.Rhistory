xlab("fragment length (nt)")+
theme_classic()
#show normalized counts to avoid not being consistent with the star-mapped data
#have to calculate histograms independently, regenerate the table and do geom_col
maximum_length<-max(test$value) #2537
minimum_length<-min(test$value) #158
minbins<-0
maxbins<-2600
nbins<-75
get_normalized_histcounts<-function(sample_index){
histo<-hist(test[which(test$L1==sample_index),"value"],breaks=seq(minbins,maxbins,(maxbins-minbins)/nbins),plot = FALSE)
histo$cpm<-histo$counts/total_mapped[sample_index]*1e6
return(data.frame(cpm=histo$cpm,mids=histo$mids,sample=rep(sample_index,nbins)))
}
norm_cpm_data<-data.frame()
for (i in seq(8)){
norm_cpm_data<-rbind(norm_cpm_data,get_normalized_histcounts(i))
}
ggplot(norm_cpm_data)+
geom_col(aes(x=mids,y=cpm,fill=factor(sample)),width=(maxbins-minbins)/nbins)+
facet_grid(factor(sample) ~ .)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/")
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/")
pi_cpms_distance<-read.table("piRNAnormalisedExpression.txt")
pi_cpms_distance
pi_cpms_distance<-read.table("piRNAnormalisedExpression.txt",header=TRUE)
pi_cpms_distance
pi_cpms_distance
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/pi_landscape_heatmap/")
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",header=TRUE)
pi_cpms_distance
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt")
pi_cpms_distance
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",sep=",")
pi_cpms_distance
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",sep=",",row.names = 1)
pi_cpms_distance
pi_cpms_distance$V12<-NULL
pi_cpms_distance$V23<-NULL
pi_cpms_distance$V34<-NULL
pi_cpms_distance$V45<-NULL
heatmap.2(as.numeric(pi_cpms_distance))
as.numeric(pi_cpms_distance)
pi_cpms_distance
read.table("../piRNAnormalisedExpression.txt")
read.table("../piRNAnormalisedExpression.txt",header=TRUE)
test<-read.table("../piRNAnormalisedExpression.txt",header=TRUE)
test
test<-test[which(test$name=="piRNA_type1"),]
test
test<-test[which(test$name=="piRNA_type1" & test$dist==2),]
table(test$sample)
test<-test[which(test$name=="piRNA_type1" | test$name=="21UR") & test$dist==2),]
test<-read.table("../piRNAnormalisedExpression.txt",header=TRUE)
test<-test[which((test$name=="piRNA_type1" | test$name=="21UR") & test$dist==2),]
table(test$sample)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/pi_landscape_heatmap/")
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",sep=",",row.names = 1)
pi_cpms_distance$V12<-NULL
pi_cpms_distance$V23<-NULL
pi_cpms_distance$V34<-NULL
pi_cpms_distance$V45<-NULL
heatmap.2(as.numeric(pi_cpms_distance))
pi_cpms_distance
heatmap.2(matrix(pi_cpms_distance))
pi_cpms_distance
heatmap.2(as.matrix(pi_cpms_distance))
heatmap.2(as.matrix(pi_cpms_distance),dendrogram = FALSE,Rowv = FALSE,Colv = FALSE)
heatmap.2(as.matrix(pi_cpms_distance),dendrogram = "none",Rowv = FALSE,Colv = FALSE)
heatmap.2(as.matrix(pi_cpms_distance),dendrogram = "none",Rowv = FALSE,Colv = FALSE,trace="none")
heatmap.2(log2(as.matrix(pi_cpms_distance)),dendrogram = "none",Rowv = FALSE,Colv = FALSE,trace="none")
heatmap.2(log2(as.matrix(pi_cpms_distance+0.001)),dendrogram = "none",Rowv = FALSE,Colv = FALSE,trace="none")
pi_cpms_distance$V10
pi_cpms_distance$V20
pi_cpms_distance
pi_cpms_distance$V10+pi_cpms_distance$V21+pi_cpms_distance$V32+pi_cpms_distance$V43+pi_cpms_distance$V54
total_signal<-pi_cpms_distance$V10+pi_cpms_distance$V21+pi_cpms_distance$V32+pi_cpms_distance$V43+pi_cpms_distance$V54
pi_cpms_distance$total_signal_minustwo<-pi_cpms_distance$V10+pi_cpms_distance$V21+pi_cpms_distance$V32+pi_cpms_distance$V43+pi_cpms_distance$V54
pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo),]
pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo,decreasing = FALSE),]
heatmap.2(as.matrix(pi_cpms_distance[1:50]),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50])),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("green", "black", "red")))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("red", "orange","yellow", "white","lightblue","darkblue")))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("maroon","orange", "white","lightblue","darkblue")))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("maroon","yellow", "white","lightblue","darkblue")))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.1)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.1)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.01)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
hist(as.matrix(pi_cpms_distance[1:50]))
hist(as.matrix(pi_cpms_distance[1:50]),breaks=300)
hist(as.matrix(pi_cpms_distance[1:50]),breaks=300,xlim=c(0,10))
hist(as.matrix(pi_cpms_distance[1:50]),breaks=3000,xlim=c(0,1))
hist(as.matrix(pi_cpms_distance[1:50]),breaks=30000,xlim=c(0,1))
pi_cpms_distance[1:50]
pi_cpms_distance[1:50][which(pi_cpms_distance[1:50]>0)]
mat<-as.matrix(pi_cpms_distance[1:50])
mat[which(mat>0)]
hist(mat[which(mat>0)])
data<-mat[which(mat>0)]
hist(data,breaks=300)
hist(data,breaks=300,xlim=c(0,10))
hist(data,breaks=3000,xlim=c(0,10))
mat[mat>2]
mat[mat>10]<-10
hist(log2(data),breaks=300)
hist(log2(data),breaks=100)
mat[mat<0.001]<-0.001
heatmap.2(mat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
mat<-as.matrix(pi_cpms_distance[1:50])
data<-mat[which(mat>0)]
hist(log2(data),breaks=100)
mat[mat>4]<-4
mat[mat<0.0001]<-0.0001
heatmap.2(log2(mat),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
colSums(pi_cpms_distance)
colSums(pi_cpms_distance)
totals<-colSums(pi_cpms_distance)
heatmap.2(totals,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
totals
totals<-log2(colSums(pi_cpms_distance)+0.0001)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(totals,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
totals
totals<-as.numeric(log2(colSums(pi_cpms_distance)+0.0001))
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(totals,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
totals
totals<-as.numeric(log10(colSums(pi_cpms_distance)))
totals<-as.matrix(log10(colSums(pi_cpms_distance)))
heatmap.2(totals,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(rbind(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),totals),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
totals<-as.matrix(log10(colSums(pi_cpms_distance)))[1:50]
heatmap.2(rbind(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),totals),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
pdf("heatmap_pis_totals_included.pdf")
heatmap.2(rbind(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),totals),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
dev.off()
a<-read.table("../piRNAnormalisedExpression.txt")
a
a<-read.table("../piRNAnormalisedExpression.txt",header=TRUE)
a<-a[which(a$dist==(-2)),]
table(a$sample)
a<-read.table("../piRNAnormalisedExpression.txt",header=TRUE)
a
a<-a[which(a$dist==2),]
table(a$sample)
a<-a[which(a$dist==2 & (a$name=="21UR" | a$name=="piRNA_type1")),]
table(a$sample)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("red","darkblue")),symbreaks = FALSE)
a<-read.table("../piRNAnormalisedExpression.txt",header=TRUE)
a<-a[which(a$dist==2 & (a$name=="21UR" | a$name=="piRNA_type1")),]
table(a$sample)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("red","yellow","darkblue")),symbreaks = FALSE)
a<-read.table("../piRNAnormalisedExpression.txt",header=TRUE)
a<-a[which(a$dist==2 & (a$name=="21UR" | a$name=="piRNA_type1")),]
table(a$sample)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("red","yellow","lightblue","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","red","yellow","lightblue","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","orange","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","red","maroon")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","red","red")),symbreaks = FALSE)
heatmap.2(totals,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","red","red")),symbreaks = FALSE)
totals<-as.matrix(log10(colSums(pi_cpms_distance)))[1:50]
totals
heatmap.2(totals,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","red","red")),symbreaks = FALSE)
heatmap.2(matrix(totals),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","red","red")),symbreaks = FALSE)
totals<-matrix(log10(colSums(pi_cpms_distance)))[1:50]
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.0001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown","yellow","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","lightblue","lightbrown","yellow","orange","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","lightblue","ocre","yellow","orange","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","lightblue","yellow","orange","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","yellow","orange","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","lightblue","pink","red","red","red")),symbreaks = FALSE)
heatmap.2(totals,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown",,"red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","lightblue","yellow","red","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","lightblue","white","yellow","red","red","red","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","lightblue","white","yellow","red","red","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","lightblue","yellow","orange","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","pink","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","red","red","red","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","pink","red","red","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","lightblue","lightblue","pink","red","red","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","pink","red","red","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","pink","red","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","pink","red","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","darkblue","red","red","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("red","darkblue","darkblue","red","red","maroon")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","darkblue","red","red","maroon")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","yellow","red","red","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","red","red","red")),symbreaks = FALSE)
mat<-pi_cpms_distance[1:50]
mat[which(mat==0)]<-NA
mat[which(mat==0)]
mat<-matrix(pi_cpms_distance[1:50])
mat[which(mat==0)]<-NA
matrix(pi_cpms_distance[1:50])
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/pi_landscape_heatmap/")
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",sep=",",row.names = 1)
pi_cpms_distance$V12<-NULL
pi_cpms_distance$V23<-NULL
pi_cpms_distance$V34<-NULL
pi_cpms_distance$V45<-NULL
pi_cpms_distance$total_signal_minustwo<-pi_cpms_distance$V10+pi_cpms_distance$V21+pi_cpms_distance$V32+pi_cpms_distance$V43+pi_cpms_distance$V54
pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo,decreasing = FALSE),]
matrix(pi_cpms_distance[1:50])
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/pi_landscape_heatmap/")
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",sep=",",row.names = 1)
pi_cpms_distance
pi_cpms_distance$V12<-NULL
pi_cpms_distance$V23<-NULL
pi_cpms_distance$V34<-NULL
pi_cpms_distance$V45<-NULL
pi_cpms_distance$total_signal_minustwo<-pi_cpms_distance$V10+pi_cpms_distance$V21+pi_cpms_distance$V32+pi_cpms_distance$V43+pi_cpms_distance$V54
pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo,decreasing = FALSE),]
mat<-matrix(pi_cpms_distance[,1:50])
mat
as.matrix(pi_cpms_distance[,1:50])
mat<-as.matrix(pi_cpms_distance[,1:50])
mat[which(mat==0)]<-NA
mat
logmat<-log10(mat)
logmat
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","red","red","red")),symbreaks = FALSE)
totals
minustwo_totals<-totals[9,19,29,39,49]
totals<-matrix(log2(colSums(pi_cpms_distance)))[1:50]
minustwo_totals<-totals[9,19,29,39,49]
minustwo_totals<-totals[c(9,19,29,39,49)]
minustwo_totals
totals<-matrix(log10(colSums(pi_cpms_distance)))[1:50]
minustwo_totals<-totals[c(9,19,29,39,49)]
minustwo_totals
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/pi_landscape_heatmap/")
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",sep=",",row.names = 1)
pi_cpms_distance$V12<-NULL
pi_cpms_distance$V23<-NULL
pi_cpms_distance$V34<-NULL
pi_cpms_distance$V45<-NULL
pi_cpms_distance$total_signal_minustwo<-pi_cpms_distance$V10+pi_cpms_distance$V21+pi_cpms_distance$V32+pi_cpms_distance$V43+pi_cpms_distance$V54
pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo,decreasing = FALSE),]
mat<-as.matrix(pi_cpms_distance[,1:50])
mat[which(mat==0)]<-NA
logmat<-log2(mat)
minustwo_totals_unlogged<-2*totals[c(9,19,29,39,49)]
minustwo_totals_unlogged
pi_cpms_distance
pi_cpms_distance<-pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo,decreasing = FALSE),]
mat<-as.matrix(pi_cpms_distance[,1:50])
mat[which(mat==0)]<-NA
logmat<-log2(mat)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","red","red","red")),symbreaks = FALSE)
pi_cpms_distance<-pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo,decreasing = TRUE),]
mat<-as.matrix(pi_cpms_distance[,1:50])
mat[which(mat==0)]<-NA
logmat<-log2(mat)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","red","red","red")),symbreaks = FALSE)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","red","red","red")),symbreaks = FALSE,na.color = "black")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","lightblue","white","red","red","red")),symbreaks = FALSE,na.color = "black")
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","pink","red","red")),symbreaks = FALSE)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","lightblue","white","pink","red","red")),symbreaks = FALSE,na.color = "black")
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","lightblue","yellow","orange","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","pink","red","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","pink","red","red")),symbreaks = FALSE)
heatmap.2(totals,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","brown",,"red","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("maroon","orange","white","lightblue","darkblue","darkblue")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","lightblue","yellow","orange","red")),symbreaks = FALSE)
heatmap.2(log2(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("darkblue","darkblue","lightblue","pink","red","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","pink","red","red")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("maroon","orange","white","lightblue","darkblue","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","blue","darkblue")),symbreaks = FALSE)
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("white","lightblue","darkblue")),symbreaks = FALSE)
pdf("test.pdf")
heatmap.2(log10(as.matrix(pi_cpms_distance[1:50]+0.001)),trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("black","darkblue","white","pink","red","red")),symbreaks = FALSE)
dev.off()
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/pi_landscape_heatmap/")
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",sep=",",row.names = 1)
pi_cpms_distance$V12<-NULL
pi_cpms_distance$V23<-NULL
pi_cpms_distance$V34<-NULL
pi_cpms_distance$V45<-NULL
pi_cpms_distance$total_signal_minustwo<-pi_cpms_distance$V10+pi_cpms_distance$V21+pi_cpms_distance$V32+pi_cpms_distance$V43+pi_cpms_distance$V54
pi_cpms_distance<-pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo,decreasing = TRUE),]
mat<-as.matrix(pi_cpms_distance[,1:50])
mat
hist(melt(mat))
melt(mat)
hist(vector(mat))
hist(mat)
mat<-as.matrix(pi_cpms_distance[,1:50])
hist(mat,breaks=3000)
hist(mat,breaks=3000,xlim=c(0,10))
hist(mat,breaks=1000,xlim=c(0,10))
hist(mat,breaks=10000,xlim=c(0,1))
hist(mat,breaks=100000,xlim=c(0,0.1))
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/CAGEr_normalized_piRNAdata/star_eleni/pi_landscape_heatmap/")
pi_cpms_distance<-read.table("all_tss_cpms.typeIpis.txt",sep=",",row.names = 1)
pi_cpms_distance$V12<-NULL
pi_cpms_distance$V23<-NULL
pi_cpms_distance$V34<-NULL
pi_cpms_distance$V45<-NULL
pi_cpms_distance$total_signal_minustwo<-pi_cpms_distance$V10+pi_cpms_distance$V21+pi_cpms_distance$V32+pi_cpms_distance$V43+pi_cpms_distance$V54
pi_cpms_distance<-pi_cpms_distance[order(pi_cpms_distance$total_signal_minustwo,decreasing = TRUE),]
mat<-as.matrix(pi_cpms_distance[,1:50])
mat
mat
hist(mat,breaks=1000,xlim=c(0,5))
hist(mat[which(mat>0)],breaks=1000,xlim=c(0,5))
hist(mat[which(mat>0)],breaks=10000,xlim=c(0,5))
mat[mat>2]
mat[mat>5]
logmat<-log2(mat)
log2(mat)
mat<-as.matrix(pi_cpms_distance[,1:50])
hist(mat[which(mat>0)],breaks=1000,xlim=c(0,5))
hist(mat[which(mat>0)],breaks=10000,xlim=c(0,5))
mat[which(mat==0)]<-NA
logmat<-log2(mat)
hist(logmat,breaks=1000,xlim=c(0,5))
hist(mat,breaks=10000,xlim=c(0,5))
hist(logmat,breaks=1000)
hist(logmat,breaks=300)
hist(logmat,breaks=70)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("red","orange","yellow","blue","drakblue","darkblue")),symbreaks = FALSE,na.color = "black")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("red","orange","yellow","blue","drakblue","darkblue"),symbreaks = FALSE,na.color = "red")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("red","orange","yellow","blue","darkblue","darkblue")),symbreaks = FALSE,na.color = "red")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("maroon","orange","yellow","blue","darkblue","darkblue")),symbreaks = FALSE,na.color = "red")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("maroon","orange","yellow","blue","darkblue","darkblue")),symbreaks = FALSE,na.color = "maroon")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("A41D29","orange","yellow","blue","darkblue","darkblue")),symbreaks = FALSE,na.color = "A41D29")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("A41D29","orange","yellow","blue","darkblue","darkblue")),symbreaks = FALSE,na.color = "A41D29")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("A41D29","orange","yellow","blue","darkblue","darkblue")),symbreaks = FALSE,na.color = "A41D29")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("A41D29","orange","yellow","blue","darkblue","darkblue")),symbreaks = FALSE,na.color = "red")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#fc8d59","#ffffbf","#91bfdb")),symbreaks = FALSE,na.color = "#fc8d59")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4")),symbreaks = FALSE,na.color = "#d73027")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4")),symbreaks = FALSE,na.color = "#d73027")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4")),
symm = T,na.color = "#d73027")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4")),
symm = T,symbreaks = FALSE,na.color = "#d73027")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4")),
symm = T,na.color = "#d73027")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","#4575b4")),
symm = T,na.color = "#d73027")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","#4575b4","#4575b4")),
symm = T,na.color = "#d73027")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","#4575b4","#4575b4","darkblue","darkblue")),
symm = T,na.color = "#d73027")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","#4575b4","#4575b4","darkblue","darkblue")),
symm = T,na.color = "#d73027")
library(RColorBrewer)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","#4575b4","darkblue","darkblue","darkblue")),
symm = T,na.color = "#d73027")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","darkblue","darkblue","black","black")),
symm = T,na.color = "#d73027")
pdf("pi_signal.pdf")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#d73027","#d73027","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","darkblue","darkblue","black","black")),
symm = T,na.color = "#d73027")
dev.off()
barplot(colSums(pi_cpms_distance))
barplot(colSums(pi_cpms_distance)[0:50])
barplot(colSums(pi_cpms_distance)[0:50],ylab="total piRNA cpm")
pdf("pi_signal_total_barplot.pdf")
barplot(colSums(pi_cpms_distance)[0:50],ylab="total piRNA cpm")
dev.off()
rgb2hsv(146,29,41)
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#921D29","#921D29","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","darkblue","darkblue","black","black")),
symm = T,na.color = "#921D29")
library(RColorBrewer)
pdf("pi_signal.pdf")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#921D29","#921D29","#d73027","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","#4575b4","darkblue","darkblue","black","black")),
symm = T,na.color = "#921D29")
dev.off()
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#921D29","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","darkblue","black","black")),
symm = T,na.color = "#921D29")
pdf("pi_signal_test.pdf")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#921D29","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","darkblue","black","black")),
symm = T,na.color = "#921D29")
dev.off()
pdf("pi_signal_test.pdf")
heatmap.2(logmat,trace="none",dendrogram="none",Rowv = FALSE,Colv = FALSE,
col=colorRampPalette(c("#921D29","#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4","darkblue","black")),
symm = T,na.color = "#921D29")
dev.off()
