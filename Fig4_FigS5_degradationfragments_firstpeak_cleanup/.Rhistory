setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
seqnames(BSgenome.Celegans.UCSC.ce11)<-c("I","II","III","IV","V","X","MtDNA")
inputFiles = list.files(path=".",pattern="*bed")
names=c("N2_EV_1","N2_EV_2","N2_I_1","N2_I_2","total","TFIIS_EV_2","TFIIS_I_1","TFIIS_I_2")
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = inputFiles
, inputFilesType = "bed"
, sampleLabels   = names)
ce
getCTSS(ce)
sessionInfo()
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
inputFiles = list.files(path=".",pattern="*bam")
inputFiles
names=c("N2_EV_1","N2_EV_2","N2_I_1","N2_I_2","total","TFIIS_EV_2","TFIIS_I_1","TFIIS_I_2")
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = inputFiles
, inputFilesType = "bam"
, sampleLabels   = names)
getCTSS(ce,
removeFirstG=TRUE,
correctSystematicG = TRUE)
BSgenome.Celegans.UCSC.ce11
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
seqnames(BSgenome.Celegans.UCSC.ce11)<-c("I","II","III","IV","V","X","MtDNA")
inputFiles = list.files(path=".",pattern="*bam")
names=c("N2_EV_1","N2_EV_2","N2_I_1","N2_I_2","total","TFIIS_EV_2","TFIIS_I_1","TFIIS_I_2")
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = inputFiles
, inputFilesType = "bam"
, sampleLabels   = names)
getCTSS(ce,
removeFirstG=TRUE,
correctSystematicG = TRUE)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
seqnames(BSgenome.Celegans.UCSC.ce11)<-c("I","II","III","IV","V","X","MtDNA")
seqlevelsStyle(BSgenome.Celegans.UCSC.ce11) <- "ENSEMBL"
inputFiles = list.files(path=".",pattern="*bam")
names=c("N2_EV_1","N2_EV_2","N2_I_1","N2_I_2","total","TFIIS_EV_2","TFIIS_I_1","TFIIS_I_2")
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = inputFiles
, inputFilesType = "bam"
, sampleLabels   = names)
getCTSS(ce,
removeFirstG=TRUE,
correctSystematicG = TRUE)
seqlevelsStyle(BSgenome.Celegans.UCSC.ce11) <- "ENSEMBL"
BSgenome.Celegans.UCSC.ce11
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
BSgenome.Celegans.UCSC.ce11
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
seqlevelsStyle(BSgenome.Celegans.UCSC.ce11) <- "ENSEMBL"
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
seqlevelsStyle(BSgenome.Celegans.UCSC.ce11) <- "ENSEMBL"
inputFiles = list.files(path=".",pattern="*bam")
inputFiles
inputFiles = list.files(path=".",pattern="*bam")[6]
inputFiles
names=c("N2_EV_1","N2_EV_2","N2_I_1","N2_I_2","total","TFIIS_EV_2","TFIIS_I_1","TFIIS_I_2")[5]
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = inputFiles
, inputFilesType = "bam"
, sampleLabels   = names)
getCTSS(ce,
removeFirstG=TRUE,
correctSystematicG = TRUE)
tss_seq<-"../../integrator_CR_ALL/germnuclei_fractionation/10_TFIIS_ints-11RNAi_np_S10_R1_001.fastq.trimmed.sorted.bed.pis"
tss_seq<-"../../integrator_CR_ALL/germnuclei_fractionation/25_N2_EV_chr_S11_R1_001.fastq.trimmed.sorted.bed.pis"
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = tss_seq
, inputFilesType = "bed"
, sampleLabels   = "tss_seq_N2")
getCTSS(ce)
tss_seq<-"../../integrator_CR_ALL/germnuclei_fractionation/25_N2_EV_chr_S11_R1_001.TEST"
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = tss_seq
, inputFilesType = "bed"
, sampleLabels   = "tss_seq_N2")
getCTSS(ce)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
BSgenome.Celegans.UCSC.ce11
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
BSgenome.Celegans.UCSC.ce11
rm(list = ls(all. names = TRUE))
rm(list = ls(all. names = TRUE))
rm(list = ls(all. names = TRUE))
BSgenome.Celegans.UCSC.ce11
rm(list = ls())
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
BSgenome.Celegans.UCSC.ce11
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = "../../integrator_CR_ALL/germnuclei_fractionation/25_N2_EV_chr_S11_R1_001.TESTform"
, inputFilesType = "bed"
, sampleLabels   = "TESTform")
getCTSS(ce)
ce
seqlevelsStyle(BSgenome.Celegans.UCSC.ce11) <- "ENSEMBL"
getCTSS(ce)
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = "../../integrator_CR_ALL/germnuclei_fractionation/25_N2_EV_chr_S11_R1_001.TEST"
, inputFilesType = "bed"
, sampleLabels   = "TESTform")
getCTSS(ce)
inputFiles = list.files(path=".",pattern="*reheader.bam")
inputFiles
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
inputFiles = list.files(path=".",pattern="*reheader.bam")[5]
names=c("N2_EV_1","N2_EV_2","N2_I_1","N2_I_2","total","TFIIS_EV_2","TFIIS_I_1","TFIIS_I_2")[5]
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = inputFiles
, inputFilesType = "bam"
, sampleLabels   = names)
getCTSS(ce,
removeFirstG=TRUE,
correctSystematicG = TRUE)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
inputFiles = list.files(path=".",pattern="*reheader.bam")
names=c("N2_EV_1","N2_EV_2","N2_I_1","N2_I_2","total","TFIIS_EV_2","TFIIS_I_1","TFIIS_I_2")
ce <- new("CAGEset"
, genomeName     = "BSgenome.Celegans.UCSC.ce11"
, inputFiles     = inputFiles
, inputFilesType = "bam"
, sampleLabels   = names)
getCTSS(ce,
removeFirstG=TRUE,
correctSystematicG = TRUE)
getCTSS
ce
head(CTSScoordinates(ce))
head(CTSStagCountDf(ce))
head(CTSStagCount(ce))
head(CTSStagCount(ce))
head(CTSStagCountDf(ce))
annotateCTSS(ce, exampleCe9_annot)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("AnnotationDbi")
help("annotateCTSS")
corr.m <- plotCorrelation2( ce, samples = "all"
, tagCountThreshold = 1, applyThresholdBoth = FALSE
, method = "pearson")
corr.m <- plotCorrelation2( ce, samples = "all"
, tagCountThreshold = 1, applyThresholdBoth = FALSE
, method = "pearson")
corr.m
librarySizes(ce)
plotReverseCumulatives(ce, fitInRange = c(5, 1000), onePlot = TRUE)
plotReverseCumulatives(ce, fitInRange = c(5, 1000), onePlot = TRUE)
normalizeTagCount(ce, method = "powerLaw", fitInRange = c(5, 1000), alpha = 1.2, T = 5*10^4)
ce[["tagCountMatrix"]]
ce[["tagCountMatrix"]]
ce
plotReverseCumulatives(ce, fitInRange = c(5, 1000), onePlot = TRUE)
normalizeTagCount(ce, method = "powerLaw", fitInRange = c(5, 1000), alpha = 1.05, T = 10^6)
ce
clusterCTSS( object = ce
, threshold = 1
, thresholdIsTpm = TRUE
, nrPassThreshold = 1
, method = "distclu"
, maxDist = 20
, removeSingletons = TRUE
, keepSingletonsAbove = 5)
cumulativeCTSSdistribution(ce, clusters = "tagClusters", useMulticore = T)
quantilePositions(ce, clusters = "tagClusters", qLow = 0.1, qUp = 0.9)
tagClustersGR( ce, "zf_unfertilized_egg"
, returnInterquantileWidth = TRUE,  qLow = 0.1, qUp = 0.9)
tagClustersGR( ce, "N2_EV_1"
, returnInterquantileWidth = TRUE,  qLow = 0.1, qUp = 0.9)
plotInterquantileWidth(ce, clusters = "tagClusters", tpmThreshold = 3, qLow = 0.1, qUp = 0.9)
sessionInfo()
head(CTSStagCount(ce))
CTSSnormalizedTpm(ce)
normalized_tpm_TSSs<-CTSSnormalizedTpm(ce)
write.table(normalized_tpm_TSSs,file="CAGEr_normalized_TSSsignal_tpm.txt",quote = FALSE)
normalized_tpm_TSSs
write.table(normalized_tpm_TSSs,file="CAGEr_normalized_TSSsignal_tpm.txt",quote = FALSE,sep="\t")
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/integrator_CAGEr/tophat_bams/")
library(CAGEr)
library(BSgenome.Celegans.UCSC.ce11)
BSgenome.Celegans.UCSC.ce11
seqlengths(BSgenome.Celegans.UCSC.ce11)
sum(seqlengths(BSgenome.Celegans.UCSC.ce11))
install.packages(c("depmixS4", "gplots", "survminer"))
library(gplots)
library(RColorBrewer)
library(ggplot2)
library(depmixS4)
library(depmixS4)
remove(list = ls())
library(depmixS4)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2")
fragments_10nt_files <- list.files(path=".",pattern="*10nt")
fragments_10nt_files
fragments_10nt_files<-paste0(path,fragments_10nt_files,sep="")
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2")
path="/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2"
fragments_10nt_files <- list.files(path=".",pattern="*10nt")
fragments_10nt_files<-paste0(path,fragments_10nt_files,sep="")
fragments_10nt_files
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2")
path="/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2/"
fragments_10nt_files <- list.files(path=".",pattern="*10nt")
fragments_10nt_files<-paste0(path,fragments_10nt_files,sep="")
fragments_10nt_files
fragments_10nt_files
fragments_10 <- lapply(fragments_10nt_files,function(i){
read.csv(i, header=FALSE,sep="\t")})
fragments_10
fragments_10 <- lapply(fragments_10nt_files,function(i){
read.csv(i, header=FALSE,sep="\t")})
fragments_10
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()+ggtitle(names[i])
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()+ggtitle(names[i])
})
library(ggplot2)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2")
path="/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2/"
fragments_10nt_files <- list.files(path=".",pattern="*10nt")
fragments_10nt_files<-paste0(path,fragments_10nt_files,sep="")
fragments_10 <- lapply(fragments_10nt_files,function(i){
read.csv(i, header=FALSE,sep="\t")})
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()+ggtitle(names[i])
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()+ggtitle(names[i])
})
names<-c("N2_EV_1","N2_ints11_1","TFIIS_EV_1","N2_EV_2","TFIIS_ints11_1","N2_ints11_2","TFIIS_EV_2","TFIIS_ints11_2")
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
})
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
head(df$distance)
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
})
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
print(df$distance)
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
})
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
print(table(df$distance))
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
})
fragments_10
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
table(df$distance)
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
})
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
print(as.data.frame(table(df$distance)))
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,30))+theme_classic()
})
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
print(as.data.frame(table(df$distance)))
dfdist<-df[,c("distance","V12")]
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()
dfdist<-unique(dfdist)
ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()
})
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
print(as.data.frame(table(df$distance)))
dfdist<-df[,c("distance","V12")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic())
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic())
})
lapply(fragments_10, function(df){
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
dfdist<-df[,c("distance","V12")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic())
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic())
})
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
dfdist<-df[,c("distance","V12")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic())
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic())
}
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
dfdist<-df[,c("distance","V12")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
}
df
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
dfdist<-df[,c("distance","V12")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
}
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
dfdist<-df[,c("distance","V12","V5")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
}
df
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
df<-df[-which(df$V1=="MtDNA"),]
dfdist<-df[,c("distance","V12","V5","V4")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_barplot(aes(x=V4,fill=V5)+theme_classic()+coord_cartesian(xlim=c(-10,10)+ggtitle(names[i]))
}
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
df<-df[-which(df$V1=="MtDNA"),]
dfdist<-df[,c("distance","V12","V5","V4")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_barplot(aes(x=V4,fill=V5)+theme_classic()+coord_cartesian(xlim=c(-10,10)+ggtitle(names[i]))
}
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
df<-df[-which(df$V1=="MtDNA"),]
dfdist<-df[,c("distance","V12","V5","V4")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_barplot(aes(x=V4,fill=V5)+theme_classic()+coord_cartesian(xlim=c(-10,10))+ggtitle(names[i]))
}
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
df<-df[-which(df$V1=="MtDNA"),]
dfdist<-df[,c("distance","V12","V5","V4")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_barplot(aes(x=V4,fill=V5))+theme_classic()+coord_cartesian(xlim=c(-10,10))+ggtitle(names[i]))
}
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
df<-df[-which(df$V1=="MtDNA"),]
dfdist<-df[,c("distance","V12","V5","V4")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_bar(aes(x=V4,fill=V5))+theme_classic()+coord_cartesian(xlim=c(-10,10))+ggtitle(names[i]))
}
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
df<-df[-which(df$V1=="MtDNA"),]
dfdist<-df[,c("distance","V12","V5","V4")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_bar(aes(x=V4,fill=V5))+theme_classic()+coord_cartesian(xlim=c(0,50))+ggtitle(names[i]))
}
library(ggplot2)
setwd("/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2")
path="/Users/ab6415/Bioinformatics/Analysis/INTEGRATOR_PAPER_ANALYSES/degr_fragments_2/"
fragments_10nt_files <- list.files(path=".",pattern="*10nt")
fragments_10nt_files<-paste0(path,fragments_10nt_files,sep="")
fragments_10 <- lapply(fragments_10nt_files,function(i){
read.csv(i, header=FALSE,sep="\t")})
names<-c("N2_EV_1","N2_ints11_1","TFIIS_EV_1","N2_EV_2","TFIIS_ints11_1","N2_ints11_2","TFIIS_EV_2","TFIIS_ints11_2")
for (i in seq(length(names))){
df<-fragments_10[[i]]
df$distance <- df$V2-df$V10
df$distance[which(df$V8=="-")]<-df$distance[which(df$V8=="-")]*(-1)
df$distance<-df$distance*(-1)
df<-df[-which(df$V1=="MtDNA"),]
dfdist<-df[,c("distance","V12","V5","V4")]
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
dfdist<-unique(dfdist)
print(ggplot(dfdist)+geom_histogram(aes(x=distance),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_histogram(aes(x=distance,fill=V5),breaks=seq(-10,10))+theme_classic()+ggtitle(names[i]))
print(ggplot(dfdist)+geom_bar(aes(x=V4,fill=V5))+theme_classic()+coord_cartesian(xlim=c(0,50))+ggtitle(names[i]))
}
fragments_10
seq(length(names))
